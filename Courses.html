<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="Courses_Style.css">
   <script src="Backend.js"></script>

    <title>Courses Tab</title>
</head>
<body>

  <header class="site-header">
			<div class="container header-inner">
				<a class="logo" href="#">Open<span>Learn</span></a>
				<button class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu">
					<span></span>
					<span></span>
					<span></span>
				</button>
				<nav class="main-nav" id="mainNav">
					<a href="Courses.html">Courses</a>
					<a href="#about">About</a>
					<a href="index.html" class="cta">Get Started</a>
				</nav>
			</div>
		</header>
        <header class="site-header">
</header>

        <section id="courses" class="courses container">
				<h2>All Popular Courses</h2>
                 <main class="container courses-main">
    <section class="resources-hero">
      <h1>Free Resources</h1>
      <p class="lead">Browse and search all free courses and resources available on OpenLearn.</p>

      <div class="filter-controls">
            <div class="filters-row">
                <label class="search-input-wrapper">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M21 21l-4.35-4.35" stroke="#9AAED8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                        <circle cx="11" cy="11" r="6" stroke="#9AAED8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></circle>
                    </svg>
                    <input id="resSearch" class="search-input" placeholder="Search resources, e.g. Java, ML..." aria-label="Search resources" />
                </label>
                <select id="levelFilter" class="select-filter" aria-label="Filter by level">
          <option value="">All levels</option>
          <option>Beginner</option>
          <option>Intermediate</option>
          <option>Advanced</option>
        </select>
                <button id="clearFilters" class="btn-outline" type="button">Clear</button>
            </div>
            <div id="tagRow" class="tag-row" aria-label="Filter by tags"></div>
      </div>
    </section>

        <section class="resources-section">
            <div id="resourcesList" class="resources-list" aria-live="polite"></div>
        </section>
  </main>

		 	

			<footer class="site-footer">
			<div class="container footer-inner">
				<div>© <span id="year"></span> OpenLearn</div>
				<div class="footer-links">
					<a href="#">Privacy</a>
					<a href="#">Terms</a>
					<a href="#contact">Contact</a>
				</div>
			</div>
		</footer>

    <script>
        const yearEl = document.getElementById('year') || document.getElementById('yearFooter');
        if (yearEl) yearEl.textContent = new Date().getFullYear();

        const activeTags = new Set();

        async function loadResources() {
            try {
                const res = await fetch('data.json');
                const data = await res.json();
                window.__resources = data;
                renderTagRow(data);
                renderResources(data);
            } catch (err) {
                const container = document.getElementById('resourcesList');
                if (container) container.innerText = 'Failed to load resources. Please refresh the page.';
                console.error('Error loading resources:', err);
            }
        }

        function createCard(item) {
            const tagsHtml = (item.tags || []).map(t => `<span class="tag-chip small">${t}</span>`).join(' ');
            const el = document.createElement('article');
            el.className = 'resource-card';
            el.innerHTML = `
                <div class="resource-main">
                    <h3><a href="${item.link}" target="_blank" rel="noopener">${item.title}</a></h3>
                    <p class="muted">${item.description}</p>
                    <div class="tag-row-small">${tagsHtml}</div>
                    <div class="meta">${item.lessons} lessons • ${item.level}</div>
                </div>
                <div class="resource-action">
                    <a class="btn-outline" href="${item.link}" target="_blank" rel="noopener">Open</a>
                </div>
            `;
            return el;
        }

        function renderTagRow(data) {
            const container = document.getElementById('tagRow');
            if (!container) return;
            const counts = {};
            data.forEach(it => (it.tags || []).forEach(t => counts[t] = (counts[t] || 0) + 1));
            container.innerHTML = '';
            Object.keys(counts).sort().forEach(tag => {
                const btn = document.createElement('button');
                btn.type = 'button';
                btn.className = 'tag-chip';
                btn.dataset.tag = tag;
                btn.textContent = `${tag} (${counts[tag]})`;
                btn.addEventListener('click', () => {
                    if (activeTags.has(tag)) {
                        activeTags.delete(tag);
                        btn.classList.remove('active');
                    } else {
                        activeTags.add(tag);
                        btn.classList.add('active');
                    }
                    applyFilters();
                });
                container.appendChild(btn);
            });
        }

        function renderResources(list) {
            const container = document.getElementById('resourcesList');
            if (!container) return;
            container.innerHTML = '';
            if (!list || list.length === 0) {
                container.innerHTML = '<p>No courses found. Try adjusting your search or filters.</p>';
                return;
            }
            const grid = document.createElement('div');
            grid.className = 'course-grid resources-grid';
            list.forEach(item => grid.appendChild(createCard(item)));
            container.appendChild(grid);
        }

        function applyFilters() {
            const q = (document.getElementById('resSearch') && document.getElementById('resSearch').value || '').toLowerCase();
            const level = (document.getElementById('levelFilter') && document.getElementById('levelFilter').value || '').toLowerCase();
            const all = window.__resources || [];
            const active = Array.from(activeTags);
            const filtered = all.filter(r => {
                const matchesQ = q === '' || (r.title + ' ' + r.description).toLowerCase().includes(q);
                const matchesLevel = level === '' || (r.level || '').toLowerCase() === level;
                const matchesTags = active.length === 0 || (r.tags || []).some(t => active.includes(t));
                return matchesQ && matchesLevel && matchesTags;
            });
            renderResources(filtered);
        }

        function injectCourseIcons() {
            document.querySelectorAll('.course-card').forEach(card => {
                if (card.querySelector('.card-icon')) return;
                const icon = document.createElement('div');
                icon.className = 'card-icon';
                icon.innerHTML = '<svg width="36" height="36" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="3" y="3" width="18" height="14" rx="2" stroke="#2563eb" stroke-width="1.5" fill="#eaf4ff"></rect><path d="M7 9h10" stroke="#2563eb" stroke-width="1.5" stroke-linecap="round"></path><path d="M7 13h6" stroke="#2563eb" stroke-width="1.5" stroke-linecap="round"></path></svg>';
                card.insertBefore(icon, card.firstChild);
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadResources();
            injectCourseIcons();
            const searchEl = document.getElementById('resSearch');
            const levelEl = document.getElementById('levelFilter');
            if (searchEl) searchEl.addEventListener('input', applyFilters);
            if (levelEl) levelEl.addEventListener('change', applyFilters);
            const clearBtn = document.getElementById('clearFilters');
            if (clearBtn) {
                clearBtn.addEventListener('click', () => {
                    if (searchEl) searchEl.value = '';
                    if (levelEl) levelEl.value = '';
                    activeTags.clear();
                    document.querySelectorAll('#tagRow .tag-chip.active').forEach(n => n.classList.remove('active'));
                    applyFilters();
                });
            }
        });
    </script>
    <script src="nav.js"></script>

</body>
</html>
